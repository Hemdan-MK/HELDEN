<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Referral Management</title>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="/admin/admin.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<style>

</style>
</head>

<body>
	<div class="sidebar">
		<div class="sidebar-brand">
			<span class="brand-full">H E L D E N</span>
			<span class="brand-short">H</span>
		</div>
		<ul class="nav flex-column mt-3">
			<li class="nav-item">
				<a class="nav-link" href="/admin/dashboard">
					<i class="fas fa-th-large"></i>
					<span>Dashboard</span>
				</a>
			</li>
			<li class="nav-item">
				<a class="nav-link" href="/admin/userManagement">
					<i class="fas fa-users"></i>
					<span>User Management</span>
				</a>
			</li>
			<li class="nav-item">
				<a class="nav-link" href="/admin/productManagement">
					<i class="fas fa-box"></i>
					<span>Product Management</span>
				</a>
			</li>
			<li class="nav-item">
				<a class="nav-link" href="/admin/orderManagement">
					<i class="fas fa-shopping-cart"></i>
					<span>Order Management</span>
				</a>
			</li>
			<li class="nav-item">
				<a class="nav-link" href="/admin/categoryManagement">
					<i class="fas fa-folder"></i>
					<span>Category Management</span>
				</a>
			</li>
			<li class="nav-item">
				<a class="nav-link" href="/admin/couponManagement">
					<i class="fas fa-ticket-alt"></i>
					<span>Coupon Management</span>
				</a>
			</li>
			<li class="nav-item">
				<a class="nav-link active" href="/admin/referralManagement">
					<i class="fas fa-gift"></i>
					<span>Referal Management</span>
				</a>
			</li>
			<li class="nav-item bottom">
				<a class="nav-link text-warning" href="/admin/logout">
					<i class="fas fa-sign-out-alt"></i>
					<span>Logout</span>
				</a>
			</li>
		</ul>
	</div>
	<div class="main-content">
		<!-- Sidebar -->

		<div class="container-fluid page-body-wrapper" style="height: 100vh;">
			<div class="container mt-5">
				<div class="d-flex justify-content-between align-items-center mb-4">
					<h4 class="mb-0">Referral Management</h4>
				</div>
				
				<div class="table-responsive">
					<table class=" ">
						<thead>
							<tr>
								<th scope="col">User</th>
								<th scope="col">Email</th>
								<th scope="col">Referral Code</th>
								<th scope="col">Referrals Count</th>
								<th scope="col">Wallet Balance</th>
								<th scope="col">Referred By</th>
							</tr>
						</thead>
						<tbody>
							<% if (users.length > 0) { %>
							<% users.forEach(user => { %>
							<tr>
								<td><%= user.name %></td>
								<td><%= user.email %></td>
								<td><span class="badge bg-transparent border border-success text-success"><%= user.referralCode ? user.referralCode : 'N/A' %></span></td>
								<td><%= user.referralCount %></td>
								<td>â‚¹ <%= user.walletBalance %></td>
								<td>
									<% if (user.referredBy) { %>
									<small class="text-muted">
										<%= user.referredBy.name %>
										<br>
										(<%= user.referredBy.email %>)
									</small>
									<% } else { %>
									<span class="badge bg-transparent border border-warning text-warning">N/A</span>
									<% } %>
								</td>
							</tr>
							<% }); %>
							<% } else { %>
							<tr>
								<td colspan="6" class="text-center py-4">
									<div class="text-muted">
										<i class="fas fa-info-circle me-2"></i>
										No users available
									</div>
								</td>
							</tr>
							<% } %>
						</tbody>
					</table>
				</div>
		
				<% if (totalPages > 1) { %>
				<nav aria-label="Page navigation" class="d-flex justify-content-between align-items-center mt-4">
					<div class="small text-white">
						Showing page <%= currentPage %> of <%= totalPages %>
					</div>
					<ul class="pagination pagination-sm mb-0">
						<li class="page-item <%= !hasPrevPage ? 'disabled' : '' %>">
							<a class="page-link" href="?page=<%= currentPage - 1 %>" <%= !hasPrevPage ? 'tabindex="-1" aria-disabled="true"' : '' %>>
								<i class="fas fa-chevron-left small"></i>
							</a>
						</li>
		
						<% for(let i = 1; i <= totalPages; i++) { %>
						<% if (i === 1 || i === totalPages || (i >= currentPage - 1 && i <= currentPage + 1)) { %>
						<li class="page-item <%= currentPage === i ? 'active' : '' %>">
							<a class="page-link" href="?page=<%= i %>"><%= i %></a>
						</li>
						<% } else if (i === currentPage - 2 || i === currentPage + 2) { %>
						<li class="page-item disabled">
							<span class="page-link">...</span>
						</li>
						<% } %>
						<% } %>
		
						<li class="page-item <%= !hasNextPage ? 'disabled' : '' %>">
							<a class="page-link" href="?page=<%= currentPage + 1 %>" <%= !hasNextPage ? 'tabindex="-1" aria-disabled="true"' : '' %>>
								<i class="fas fa-chevron-right small"></i>
							</a>
						</li>
					</ul>
				</nav>
				<% } %>
			</div>
		</div>
	</div>

	<!-- Scripts -->
	<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>

</body>

</html>